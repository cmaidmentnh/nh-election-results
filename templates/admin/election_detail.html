{% extends "admin/base.html" %}

{% block title %}{{ election.year }} {{ election.election_type }}{% endblock %}

{% block content %}
<p><a href="{{ url_for('admin.elections') }}">&larr; All Elections</a></p>

<h2>{{ election.year }} {{ election.election_type }}{% if election.party %} ({{ election.party }}){% endif %}</h2>

<div class="card">
    <h3>Add Race</h3>
    <form method="POST" action="{{ url_for('admin.create_race', election_id=election.id) }}">
        <div class="form-row">
            <div class="form-group">
                <label>Office</label>
                <select name="office_id" required>
                    <option value="">Select...</option>
                    {% for o in offices %}
                    <option value="{{ o.id }}">{{ o.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label>County</label>
                <input type="text" name="county" placeholder="e.g., Carroll">
            </div>
            <div class="form-group">
                <label>District</label>
                <input type="text" name="district" placeholder="e.g., 7">
            </div>
            <div class="form-group">
                <label>Seats</label>
                <input type="number" name="seats" value="1" min="1">
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Add Race</button>
    </form>
</div>

<div class="card">
    <h3>Races in this Election</h3>
    {% if races %}
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Office</th>
                <th>District</th>
                <th>Seats</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for r in races %}
            <tr>
                <td>{{ r.id }}</td>
                <td>{{ r.office_name }}</td>
                <td>{% if r.county %}{{ r.county }} {% endif %}{{ r.district or 'Statewide' }}</td>
                <td>{{ r.seats }}</td>
                <td>
                    <a href="{{ url_for('admin.race_detail', race_id=r.id) }}">Edit</a>
                    <a href="{{ url_for('entry.race_entry', race_id=r.id) }}">Enter Results</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-muted">No races yet. Add one above.</p>
    {% endif %}
</div>
{% endblock %}
